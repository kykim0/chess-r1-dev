# Format checks enforced on CI:
# 1. Comments must appear above each field.
# 2. There must be a blank line between each field.
# 3. Inline comments (after a field on the same line) are not allowed.
# 4. Indentation level is respected for nested fields.

# specify the default per-component configs
defaults:
  - ppo_trainer
  - override reward_model@reward_model: chess_reward_model
  - _self_

# Algorithm configuration
algorithm:
  gamma: 1.0
  lam: 1.0
  adv_estimator: grpo
  norm_adv_by_std_in_grpo: true
  kl_control:
    type: fixed  # or "adaptive"
    kl_coef: 0.001
    horizon: 10000
    target_kl: 0.1

trainer:
  total_training_steps: null
  project_name: grpo_chess
  experiment_name: lichess_grpo
  logger: ["console", "wandb"]
  nnodes: 1
  n_gpus_per_node: 4
  save_freq: -1
  test_freq: -1

# Data configuration (remains similar)
data:
  seed: 1
  train_files: ~/data/chess/train.parquet
  val_files: ~/data/chess/val.parquet
  prompt_key: prompt
  max_prompt_length: 256
  max_response_length: 1024
  train_batch_size: 1024
  val_batch_size: null
  shuffle: true
  train_num_workers: 0
  val_num_workers: 0
  apply_chat_template_kwargs:
    enable_thinking: true

reward_model:
  num_examine: 3
  reward_manager: "chess_base"
  chess_model_type: "action_value"  # [action_value, behavioral_cloning, state_value]
  reward_kwargs:
    format_reward: 0.1
    english_reward: 0.1
    answer_reward: 0.0
    qvalue_reward_scaler: 1.0
  
  evaluation:
    num_examine: 3
    reward_manager: "chess_lichess"
